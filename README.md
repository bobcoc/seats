# 学生选座系统使用说明

## 系统简介
这是一个简易的学生选座系统，允许学生在线选择座位（01-48号）并填写姓名和学号信息。系统会自动生成Excel文件，其中座位号作为考号使用。

## 功能特点
- 🎯 **在线选座**：学生可以实时查看座位状态并选择空闲座位
- 📝 **信息收集**：收集学生姓名和学号信息
- 🔄 **实时更新**：座位状态实时同步，防止重复选择
- 📊 **管理界面**：提供管理员界面查看选座统计和导出数据
- 📁 **Excel导出**：一键导出座位分配Excel文件

## 文件结构
```
seats/
├── seat_selection.py      # 主程序文件
├── requirements.txt       # Python依赖包列表
├── start.sh              # 启动脚本（macOS/Linux）
├── README.md             # 使用说明
├── templates/            # HTML模板文件夹
│   ├── seat_selection.html  # 学生选座界面
│   └── admin.html           # 管理员界面
└── seat_selection.db     # SQLite数据库（运行后自动生成）
```

## 安装和启动

### 前置条件
请确保您已经安装了以下依赖包：
```bash
# 安装必需的Python包
pip install Flask pandas openpyxl
# 或者使用pip3
pip3 install Flask pandas openpyxl
```

### 启动方法

#### 方法一：使用启动脚本（推荐）

**macOS/Linux 系统：**
```bash
# 在终端中进入项目目录
cd /Users/liushuming/Desktop/seats

# 给启动脚本添加执行权限
chmod +x start.sh

# 运行启动脚本
./start.sh
```

**Windows 系统：**
```cmd
# 在命令提示符中进入项目目录
cd C:\path\to\seats

# 运行启动脚本
start.bat
```

#### 方法二：直接启动
```bash
python3 seat_selection.py
```

## 使用流程

### 1. 启动系统
运行启动脚本或直接运行Python程序后，系统会显示：
```
==================================================
学生选座系统启动中...
请将以下链接发送给学生：
http://localhost:5000
管理员界面：http://localhost:5000/admin
==================================================
```

### 2. 学生选座
1. 学生访问 `http://localhost:5000`
2. 填写姓名和学号
3. 点击选择空闲座位（绿色）
4. 点击"确认选座"按钮完成选座

### 3. 管理员管理
1. 访问 `http://localhost:5000/admin` 查看管理界面
2. 实时查看选座统计和学生信息
3. 点击"导出Excel文件"生成座位分配表
4. 如需重新开始，可点击"清空所有数据"

### 4. 导出Excel文件
- Excel文件包含三列：考号（座位号）、姓名、学号
- 文件名格式：`seat_selection_YYYYMMDD_HHMMSS.xlsx`
- 可直接用于您现有的座位分配程序

## 系统特性

### 座位管理
- 座位编号：01-48（可在代码中修改）
- 防重复选择：一个座位只能被一个学生选择
- 防重复提交：一个学号只能选择一个座位
- 实时同步：座位状态每5秒自动更新

### 数据安全
- 使用SQLite本地数据库存储
- 数据持久化保存
- 支持数据导出和清空

### 界面友好
- 响应式设计，支持手机和电脑访问
- 直观的座位图显示
- 实时状态反馈
- 管理员统计面板

## 技术规格

### 系统要求
- Python 3.7 或更高版本
- 支持的操作系统：macOS、Linux、Windows
- 浏览器：Chrome、Firefox、Safari、Edge

### 依赖包
- Flask 2.3.3：Web框架
- pandas 2.1.1：数据处理
- openpyxl 3.1.2：Excel文件操作

### 网络配置
- 默认端口：5000
- 支持局域网访问（0.0.0.0绑定）
- 可通过修改代码更改端口

## 常见问题

### Q: 如何修改座位数量？
A: 在 `seat_selection.py` 中修改这一行：
```python
all_seats = [f"{i:02d}" for i in range(1, 49)]  # 改为你需要的数量
```

### Q: 如何更改端口？
A: 在 `seat_selection.py` 最后一行修改：
```python
app.run(host='0.0.0.0', port=5000, debug=True)  # 改为你需要的端口
```

### Q: 如何在其他电脑访问？
A: 将 `localhost` 替换为运行服务器的电脑IP地址，如：
`http://192.168.1.100:5000`

### Q: Excel文件在哪里？
A: Excel文件会保存在项目目录中，文件名包含时间戳。

## 注意事项

1. **网络要求**：确保学生设备能访问运行服务器的电脑
2. **浏览器兼容**：建议使用现代浏览器
3. **数据备份**：重要数据请及时导出Excel文件备份
4. **端口占用**：确保5000端口未被其他程序占用
5. **权限问题**：在某些系统上可能需要管理员权限

## 联系支持
如有问题或需要定制功能，请联系系统管理员。